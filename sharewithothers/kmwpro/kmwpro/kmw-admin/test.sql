-- METADATA BEGIN
-- @DESC    A1411金融机构资产负债项目月报表（人民币）(存贷款部分)
-- @SRC     FDM_FUND_MMFUND 资金业务信息表 FDM_CUST_C 对公客户信息表 FDM_LOAN_ACCT 贷款借据信息表 FDM_CUST_P 个人客户信息表
-- @SRC     FDM_FUND_ASSETS_SALE 资产买卖借贷信息表 FDM_FUND_BOND_HOLD 债券信息表 FDM_FUND_INVEST 投资信息表  FDM_DEPO_ACCT 存款账户信息表 
-- @TGT     DM_DATA.rep_data
-- @AUTHOR  马富强
-- @EDIT_DATE  20171028
---@EDIT_NOTE  初建该表
---METADATA END

set hive.exec.dynamic.partition.mode = nonstrict;
alter table dm_data.rep_data drop partition(data_dt_id='${hiveconf:data_dt}', crt_no_id ${hiveconf:crt_condition}, report_id_id='612');
----------------------------------------------------------------------------------------------------
--标识:缺失的资金部分01此标识与下面脚本无关
USE DM_DATA;
INSERT INTO TABLE DM_DATA.REP_DATA  PARTITION (DATA_DT_ID ,CRT_NO_ID ,REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49, 
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
  FROM (SELECT '612' AS REPORT_ID,
               ITEM_CD AS ITEM_CD,
               CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
               SUM(ITEMVALUE1) AS ITEMVALUE1,
               CRT_NO
          FROM( SELECT A.CRT_NO,
                       (CASE WHEN (C.CUST_TYP='C042005' OR A.ACCT_TYP LIKE 'L074001002%' ) AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M37' -- 短期   个人经营性贷款
                             WHEN (C.CUST_TYP='C042005' OR A.ACCT_TYP LIKE 'L074001002%' ) AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5A' -- 中长期 个人经营性贷款
                             END) AS ITEM_CD,
                       SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1
                  FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表
                  LEFT OUTER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                               ON A.CUST_ID = C.CUST_ID --客户号
                              AND A.CRT_NO_ID = C.CRT_NO_ID
                              AND C.DATA_DT_ID='${hiveconf:data_dt}' 
                              AND C.CRT_NO_ID ${hiveconf:crt_condition}
                              AND C.SRCSYS_CD_ID = 'CMIS'
                 WHERE A.CRT_NO_ID  ${hiveconf:crt_condition} 
                   AND A.DATA_DT_ID='${hiveconf:data_dt}'
                   AND A.CURR_CD='CNY'
                   AND A.ACCT_STS != 'L002003' --账户状态 !=结清
                  GROUP BY A.CRT_NO,
                           (CASE WHEN (C.CUST_TYP='C042005' OR A.ACCT_TYP LIKE 'L074001002%' ) AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M37' -- 短期   个人经营性贷款
                                 WHEN (C.CUST_TYP='C042005' OR A.ACCT_TYP LIKE 'L074001002%' ) AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5A' -- 中长期 个人经营性贷款
                                 END)) SS 
        GROUP BY ITEM_CD,CRT_NO) T
 WHERE T.ITEM_CD IS NOT NULL ;

INSERT INTO TABLE DM_DATA.REP_DATA  PARTITION (DATA_DT_ID ,CRT_NO_ID ,REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49,
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
  FROM
  (select '612' AS REPORT_ID,
               ITEM_CD AS ITEM_CD,
               CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
               SUM(ITEMVALUE1) AS ITEMVALUE1,
               CRT_NO
               from (
               SELECT '612' AS REPORT_ID,
               (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001001'    THEN '12M3B' -- 短期   个人住房贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001004'    THEN '12M3D' -- 短期   个人助学贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003001' THEN '12M3C' -- 短期   个人汽车贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074002001'    THEN '12M3H' -- 短期   单位经营贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003002' THEN '12M3E' -- 短期   其他个人消费贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002005'    THEN '12M3K' -- 短期   L074002005 并购贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002002'    THEN '12M3I' -- 短期   L074002002 单位固定资产贷款 
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001001'    THEN '12M54' -- 中长期 个人住房贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001004'    THEN '12M56' -- 中长期 个人助学贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003001' THEN '12M55' -- 中长期 个人汽车贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003002' THEN '12M57' -- 中长期 其他个人消费贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002001'    THEN '12M5C' -- 中长期 流动资金贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002002'    THEN '12M5D' -- 中长期 L074002002 单位固定资产贷款 
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002005'    THEN '12M5E' -- 中长期 L074002005 并购贷款
                     END) ITEM_CD,
               CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
               A.CRT_NO,
               SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1
          FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表
         WHERE A.CRT_NO_ID ${hiveconf:crt_condition} 
           AND A.DATA_DT_ID='${hiveconf:data_dt}'
           AND A.CURR_CD='CNY'
           AND A.ACCT_STS != 'L002003' --账户状态 !=结清
         GROUP BY A.CRT_NO,
               (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001001'    THEN '12M3B' -- 短期   个人住房贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001004'    THEN '12M3D' -- 短期   个人助学贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003001' THEN '12M3C' -- 短期   个人汽车贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074002001'    THEN '12M3H' -- 短期   单位经营贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003002' THEN '12M3E' -- 短期   其他个人消费贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002005'    THEN '12M3K' -- 短期   L074002005 并购贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002002'    THEN '12M3I' -- 短期   L074002002 单位固定资产贷款 
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001001'    THEN '12M54' -- 中长期 个人住房贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001004'    THEN '12M56' -- 中长期 个人助学贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003001' THEN '12M55' -- 中长期 个人汽车贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,13) = 'L074001003002' THEN '12M57' -- 中长期 其他个人消费贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002001'    THEN '12M5C' -- 中长期 流动资金贷款
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002002'    THEN '12M5D' -- 中长期 L074002002 单位固定资产贷款 
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) AND SUBSTR(A.ACCT_TYP,1,10) = 'L074002005'    THEN '12M5E' -- 中长期 L074002005 并购贷款
                     END)
        UNION ALL
        SELECT   '612' AS REPORT_ID,
                  (CASE WHEN  CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M3H' -- 短期   单位经营性贷款
                             WHEN  CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5C' -- 中长期 单位经营性贷款
                             END) AS ITEM_CD,
                  CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,           
                  A.CRT_NO,           
                       -SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1
                  FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表
                  INNER  JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                               ON A.CUST_ID = C.CUST_ID --客户号
                              AND A.CRT_NO_ID = C.CRT_NO_ID
                              AND C.DATA_DT_ID='${hiveconf:data_dt}' 
                              AND C.CRT_NO_ID ${hiveconf:crt_condition}
                              AND C.SRCSYS_CD_ID = 'CMIS'
                              AND C.INLANDORRSHORE_FLG='C027001'
                              AND C.CUST_TYP='C042005'
                 WHERE A.CRT_NO_ID  ${hiveconf:crt_condition} 
                   AND A.DATA_DT_ID='${hiveconf:data_dt}'
                   AND A.CURR_CD='CNY'
                   AND A.ACCT_STS != 'L002003' --账户状态 !=结清
                  GROUP BY A.CRT_NO,
                           (CASE WHEN  CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M3H' -- 短期   单位经营性贷款
                                 WHEN  CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5C' -- 中长期 单位经营性贷款
                            END)                
                   ) tt GROUP BY ITEM_CD,CRT_NO
                     
        ) T
 WHERE T.ITEM_CD IS NOT NULL ;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49, 
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
   FROM (SELECT '612' AS REPORT_ID,
               (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M41'
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5M' 
                     END) AS ITEM_CD,
                CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
                A.CRT_NO,
                SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1 -- 贷款余额
           FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表
          WHERE A.CRT_NO_ID ${hiveconf:crt_condition}
            AND A.DATA_DT_ID='${hiveconf:data_dt}'
            AND A.ITEM_CD LIKE '1307%' -- 贸易融资
            AND A.CURR_CD='CNY'
            AND A.ACCT_STS != 'L002003' --账户状态 !=结清
          GROUP BY A.CRT_NO,
               (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M41'
                     WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M5M' 
                     END)) T
  WHERE T.ITEM_CD IS NOT NULL ;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49, 
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
   FROM (SELECT '612' AS REPORT_ID,
                (CASE WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,13) = 'C082002001001' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4J' -- 中长期  中央银行
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002002'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4K' -- 中长期  银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002004'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4M' -- 中长期  非银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,13) = 'C082002001001' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6E' -- 短期    中央银行
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002002'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6F' -- 短期    银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002004'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6G' -- 短期    非银行业金融机构
                      END) ITEM_CD,
                CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
                A.CRT_NO,
                SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1 -- 贷款余额
           FROM FDM_DATA.FDM_LOAN_ACCT A  -- 贷款借据信息表
           INNER JOIN FDM_DATA.FDM_CUST_C T1 -- 对公客户信息表
                   ON A.CUST_ID = T1.CUST_ID
                  AND A.CRT_NO_ID = T1.CRT_NO_ID
                  AND T1.SRCSYS_CD_ID='CMIS'
                  AND T1.RESIDENT_FLG = 'C024002' -- 居民标志 : 非居民
           WHERE A.CRT_NO_ID ${hiveconf:crt_condition} 
             AND A.DATA_DT_ID='${hiveconf:data_dt}'
             AND A.CURR_CD='CNY'
             AND A.ACCT_STS != 'L002003' --账户状态 !=结清
           GROUP BY A.CRT_NO,
                (CASE WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,13) = 'C082002001001' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4J' -- 中长期  中央银行
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002002'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4K' -- 中长期  银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002004'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4M' -- 中长期  非银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,13) = 'C082002001001' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6E' -- 短期    中央银行
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002002'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6F' -- 短期    银行业金融机构
                      WHEN SUBSTR(T1.FINANCE_CUST_TYP,1,10) = 'C082002004'    AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2)) > DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6G' -- 短期    非银行业金融机构
                      END)) T
 WHERE T.ITEM_CD IS NOT NULL ;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49, 
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
   FROM (SELECT '612' AS REPORT_ID,
                (CASE WHEN NVL(C.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4N' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN NVL(C.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6H' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      WHEN NVL(P.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4P' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN NVL(P.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6I' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      END) ITEM_CD,
                CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
                A.CRT_NO,
                SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1 -- 贷款余额
           FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表 
           LEFT JOIN FDM_DATA.FDM_CUST_P P -- 个人客户信息表
                   ON A.CUST_ID = P.CUST_ID
                  AND A.CUST_ID = P.CRT_NO_ID
                  AND P.SRCSYS_CD_ID='CMIS'
                  AND P.RESIDENT_FLG = 'C024002' -- 居民标志 : 非居民
           LEFT JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                   ON A.CUST_ID = C.CUST_ID
                  AND A.CUST_ID = C.CRT_NO_ID
                  AND C.SRCSYS_CD_ID='CMIS'
                  AND C.RESIDENT_FLG = 'C024002' -- 居民标志 : 非居民
                  AND C.CUST_TYP IN ('C042001','C042002','C042003','C042004') --客户分类=企业法人-中央政府投资的公用企业,企业法人-其它--只需区分到企业即可,代表处(驻华机构),非法人企业单位
           WHERE A.CRT_NO_ID ${hiveconf:crt_condition}
             AND A.DATA_DT_ID='${hiveconf:data_dt}'
             AND A.CURR_CD='CNY'
             AND A.ACCT_STS != 'L002003' --账户状态 !=结清
           GROUP BY A.CRT_NO,
                (CASE WHEN NVL(C.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4N' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN NVL(C.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6H' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      WHEN NVL(P.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4P' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN NVL(P.CUST_ID,'') != '' AND CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6I' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      END) ) T
 WHERE T.ITEM_CD IS NOT NULL ;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT CRT_NO AS ORGAN_ID,
       REPORT_DATE,
       CREATE_DATE,
       REPORT_ID,
       ITEM_CD AS ITEM_ID,
       T.ITEMVALUE1,
       0.0 AS ITEMVALUE2,  0.0 AS ITEMVALUE3,  0.0 AS ITEMVALUE4,
       0.0 AS ITEMVALUE5,  0.0 AS ITEMVALUE6,  0.0 AS ITEMVALUE7,
       0.0 AS ITEMVALUE8,  0.0 AS ITEMVALUE9,  0.0 AS ITEMVALUE10,
       0.0 AS ITEMVALUE11, 0.0 AS ITEMVALUE12, 0.0 AS ITEMVALUE13, 
       0.0 AS ITEMVALUE14, 0.0 AS ITEMVALUE15, 0.0 AS ITEMVALUE16,
       0.0 AS ITEMVALUE17, 0.0 AS ITEMVALUE18, 0.0 AS ITEMVALUE19,
       0.0 AS ITEMVALUE20, 0.0 AS ITEMVALUE21, 0.0 AS ITEMVALUE22,
       0.0 AS ITEMVALUE23, 0.0 AS ITEMVALUE24, 0.0 AS ITEMVALUE25,
       0.0 AS ITEMVALUE26, 0.0 AS ITEMVALUE27, 0.0 AS ITEMVALUE28,
       0.0 AS ITEMVALUE29, 0.0 AS ITEMVALUE30, 0.0 AS ITEMVALUE31,
       0.0 AS ITEMVALUE32, 0.0 AS ITEMVALUE33, 0.0 AS ITEMVALUE34,
       0.0 AS ITEMVALUE35, 0.0 AS ITEMVALUE36, 0.0 AS ITEMVALUE37,
       0.0 AS ITEMVALUE38, 0.0 AS ITEMVALUE39, 0.0 AS ITEMVALUE40,
       0.0 AS ITEMVALUE41, 0.0 AS ITEMVALUE42, 0.0 AS ITEMVALUE43,
       0.0 AS ITEMVALUE44, 0.0 AS ITEMVALUE45, 0.0 AS ITEMVALUE46,
       0.0 AS ITEMVALUE47, 0.0 AS ITEMVALUE48, 0.0 AS ITEMVALUE49, 
       0.0 AS ITEMVALUE50,
       '' AS PKID,
       '${hiveconf:data_dt}' AS ETL_DT_ID,
       CRT_NO,
       REPORT_ID
   FROM (SELECT '612' AS REPORT_ID,
                (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4Q' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6J' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      END) ITEM_CD,
                CONCAT(SUBSTR('${hiveconf:data_dt}',1,6),'00') AS REPORT_DATE,from_unixtime(unix_timestamp(),'yyyyMMdd') AS CREATE_DATE,
                A.CRT_NO,
                SUM(A.LOAN_ACCT_BAL) AS ITEMVALUE1 -- 贷款余额
           FROM FDM_DATA.FDM_LOAN_ACCT A -- 贷款借据信息表
           INNER JOIN FDM_DATA.FDM_CUST_P T1 -- 个人客户信息表
                   ON A.CUST_ID = T1.CUST_ID
                  AND A.CUST_ID = T1.CRT_NO_ID
                  AND T1.SRCSYS_CD_ID='CMIS'
                  AND T1.RESIDENT_FLG = 'C024002' -- 居民标志 : 非居民
                  AND SUBSTR(A.ACCT_TYP,1,10) = 'L074001001' -- 贷款类型=个人住房贷款
           WHERE A.CRT_NO_ID ${hiveconf:crt_condition} 
             AND A.DATA_DT_ID='${hiveconf:data_dt}'
             AND A.CURR_CD='CNY'
             AND A.ACCT_STS != 'L002003' --账户状态 !=结清
           GROUP BY A.CRT_NO,
                (CASE WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))<= DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M4Q' -- 贷款原始期限类型=三个月以内,三个月至六个月,六个月至一年
                      WHEN CONCAT(SUBSTR(A.MATURITY_DT,1,4),'-',SUBSTR(A.MATURITY_DT,5,2),'-',SUBSTR(A.MATURITY_DT,7,2))>  DATE_ADD(CONCAT(SUBSTR(A.DRAWDOWN_DT,1,4),'-',SUBSTR(A.DRAWDOWN_DT,5,2),'-',SUBSTR(A.DRAWDOWN_DT,7,2)),365) THEN '12M6J' -- 贷款原始期限类型=一年至两年,两年至三年,三年至五年,五年以上
                      END)) T
 WHERE T.ITEM_CD IS NOT NULL ;
 
--标识:缺失的资金部分02此标识与下面脚本无关

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MG7' -- 账户类型=活期存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MG8' -- 账户类型=活期存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MG9' -- 账户类型=活期存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGE' -- 账户类型=定期存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MGF' -- 账户类型=定期存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MGG' -- 账户类型=定期存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGM' -- 账户类型=通知存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MGN' -- 账户类型=通知存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MGP' -- 账户类型=通知存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGU' -- 账户类型=协议存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MH1' -- 账户类型=协议存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MH2' -- 账户类型=协议存款,客户分类=住房公积金
             WHEN A.ACCT_TYPE = 'M030006'             AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MH7' -- 账户类型=协定存款,客户分类=社保基金
             WHEN A.ACCT_TYPE = 'M030006'             AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MH8' -- 账户类型=协定存款,客户分类=部队
             WHEN A.ACCT_TYPE = 'M030006'             AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MH9' -- 账户类型=协定存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MHE' -- 账户类型=保证金存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MHF' -- 账户类型=保证金存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MHG' -- 账户类型=保证金存款,客户分类=住房公积金
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID
         AND C.SRCSYS_CD_ID = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID  ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND C.RESIDENT_FLG != 'C024002' -- 居民标识 != 非居民
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
  GROUP BY A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MG7' -- 账户类型=活期存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MG8' -- 账户类型=活期存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MG9' -- 账户类型=活期存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGE' -- 账户类型=定期存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MGF' -- 账户类型=定期存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MGG' -- 账户类型=定期存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGM' -- 账户类型=通知存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MGN' -- 账户类型=通知存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MGP' -- 账户类型=通知存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MGU' -- 账户类型=协议存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MH1' -- 账户类型=协议存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MH2' -- 账户类型=协议存款,客户分类=住房公积金
             WHEN A.ACCT_TYPE = 'M030006'             AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MH7' -- 账户类型=协定存款,客户分类=社保基金
             WHEN A.ACCT_TYPE = 'M030006'             AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MH8' -- 账户类型=协定存款,客户分类=部队
             WHEN A.ACCT_TYPE = 'M030006'             AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MH9' -- 账户类型=协定存款,客户分类=住房公积金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND (C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%') THEN '12MHE' -- 账户类型=保证金存款,客户分类=社保基金
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND (C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%')         THEN '12MHF' -- 账户类型=保证金存款,客户分类=部队
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' AND  C.CUST_NAM LIKE '%住房公积金%'                                    THEN '12MHG' -- 账户类型=保证金存款,客户分类=住房公积金
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT T.CRT_NO,
               T.ITEM_CD,
               SUM(T.ITEMVALUE1) AS ITEMVALUE1
          FROM (SELECT A.CRT_NO,
                '12MG5'  AS ITEM_CD,
                SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                         ELSE 0
                         END) AS ITEMVALUE1 -- 账户余额 
          FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
          INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                  ON A.CUST_ID = C.CBOD_CUST_ID 
                 AND C.SRCSYS_CD = 'CBOD'
          WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.CRT_NO_ID ${hiveconf:crt_condition}
            AND C.DATA_DT_ID = '${hiveconf:data_dt}'
            AND C.RESIDENT_FLG != 'C024002' -- 居民标识！=非居民
            AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
            AND A.ACCT_BALANCE > 0 -- 账户余额 >0
            AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20010505','20019905')
            AND SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' -- 账户类型=活期存款
            AND C.CUST_NAM NOT LIKE '%社保基金%'
            AND C.CUST_NAM NOT LIKE '%社会保障基金%'
            AND C.CUST_NAM NOT LIKE '%部队%'
            AND C.CUST_NAM NOT LIKE '%军队%' 
            AND C.CUST_NAM NOT LIKE '%住房公积金%'
            GROUP BY A.CRT_NO 
        UNION ALL
        SELECT A.CRT_NO,
                '12MG5'  AS ITEM_CD,
                SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                         ELSE 0
                         END) AS ITEMVALUE1 -- 账户余额 
          FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
          INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                  ON A.CUST_ID = C.CBOD_CUST_ID 
                 AND C.SRCSYS_CD = 'CBOD'
          WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.CRT_NO_ID ${hiveconf:crt_condition}    
            AND C.DATA_DT_ID = '${hiveconf:data_dt}'
            AND C.RESIDENT_FLG != 'C024002' -- 居民标识！=非居民
            AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
            AND A.ACCT_BALANCE > 0 -- 账户余额 >0
            AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20051005','20052005')
            AND SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' -- 账户类型=活期存款
          GROUP BY A.CRT_NO ) T
  GROUP BY T.CRT_NO, T.ITEM_CD) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
              '12MGC'  AS ITEM_CD,
              SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                       ELSE 0
                       END) AS ITEMVALUE1 -- 账户余额 
        FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
        INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                ON A.CUST_ID = C.CBOD_CUST_ID 
               AND C.SRCSYS_CD = 'CBOD'
        WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
          AND A.CRT_NO_ID ${hiveconf:crt_condition}    
          AND C.DATA_DT_ID = '${hiveconf:data_dt}'
          AND C.RESIDENT_FLG != 'C024002' -- 居民标识 != 非居民 
          AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
          AND A.ACCT_BALANCE > 0 -- 账户余额 >0
          AND SUBSTR(A.GL_ITEM_CODE,1,6) NOT IN ('200220','200215','200240','200235','200206')
          AND SUBSTR(A.GL_ITEM_CODE,1,4) NOT IN ('2004','2003')
          AND SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' -- 账户类型=定期存款
          AND C.CUST_NAM NOT LIKE '%社保基金%'
          AND C.CUST_NAM NOT LIKE '%社会保障基金%'
          AND C.CUST_NAM NOT LIKE '%部队%'
          AND C.CUST_NAM NOT LIKE '%军队%' 
          AND C.CUST_NAM NOT LIKE '%住房公积金%'
          GROUP BY A.CRT_NO ) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
               (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MGJ' -- 账户类型=通知存款
                     WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MGS' -- 账户类型=协议存款
                     END) AS ITEM_CD,
                SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                         ELSE 0
                         END) AS ITEMVALUE1 -- 账户余额 
          FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
          INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                  ON A.CUST_ID = C.CBOD_CUST_ID 
                 AND C.SRCSYS_CD = 'CBOD'
          WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.CRT_NO_ID ${hiveconf:crt_condition} 
            AND C.DATA_DT_ID = '${hiveconf:data_dt}'
            AND C.RESIDENT_FLG != 'C024002' -- 居民标识 !=非居民
            AND C.SRCSYS_CD='CBOD'
            AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
            AND C.ID_TYPE != 'C006003' -- 证件类型 社会团体证
            AND A.ACCT_BALANCE > 0 -- 账户余额 >0
            AND C.CUST_NAM NOT LIKE '%社保基金%'
            AND C.CUST_NAM NOT LIKE '%社会保障基金%'
            AND C.CUST_NAM NOT LIKE '%部队%'
            AND C.CUST_NAM NOT LIKE '%军队%' 
            AND C.CUST_NAM NOT LIKE '%住房公积金%'
            GROUP BY A.CRT_NO,
               (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MGJ' -- 账户类型=通知存款
                     WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MGS' -- 账户类型=协议存款
                     END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

 USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
               '12MGK'  AS ITEM_CD,
               SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                        ELSE 0
                        END) AS ITEMVALUE1 -- 账户余额 
         FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
         INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                 ON A.CUST_ID = C.CBOD_CUST_ID 
                AND C.SRCSYS_CD = 'CBOD'
         WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
           AND A.CRT_NO_ID ${hiveconf:crt_condition}    
           AND C.DATA_DT_ID = '${hiveconf:data_dt}'
           AND C.RESIDENT_FLG != 'C024002' -- 居民标识！=非居民
           AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
           AND A.ACCT_BALANCE > 0 -- 账户余额 >0
           AND SUBSTR(A.GL_ITEM_CODE,1,8) = '20024005'
           AND SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' -- 账户类型=通知存款
           AND C.ID_TYPE = 'C006003'  -- 证件类型 社会团体证
         GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       '12MVS' AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20040530','20040535','20040636','20040660','20041510','20041515','20042010','20042015','20041010','20041015','20043010','20043015','20022030','20022035')
  GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
               (CASE WHEN SUBSTR(A.GL_ITEM_CODE,1,6) IN ('200105','200199') THEN '12MH5'
                     WHEN SUBSTR(A.GL_ITEM_CODE,1,8) = '20011005'           THEN '12MH6'
                     END) AS ITEM_CD,
               SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                        ELSE 0
                        END) AS ITEMVALUE1 -- 账户余额 
         FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
         INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                 ON A.CUST_ID = C.CBOD_CUST_ID 
                AND C.SRCSYS_CD_ID = 'CBOD'
         WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
           AND A.CRT_NO_ID ${hiveconf:crt_condition}    
           AND C.DATA_DT_ID = '${hiveconf:data_dt}'
           AND C.RESIDENT_FLG != 'C024002' -- 居民标识!=非居民
           AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
           AND A.ACCT_BALANCE > 0 -- 账户余额 >0
           AND A.ACCT_TYPE = 'M030006' -- 账户类型=协定存款
           AND C.CUST_NAM NOT LIKE '%社保基金%'
           AND C.CUST_NAM NOT LIKE '%社会保障基金%'
           AND C.CUST_NAM NOT LIKE '%部队%'
           AND C.CUST_NAM NOT LIKE '%军队%' 
           AND C.CUST_NAM NOT LIKE '%住房公积金%'
           GROUP BY A.CRT_NO,
               (CASE WHEN SUBSTR(A.GL_ITEM_CODE,1,6) IN ('200105','200199') THEN '12MH5'
                     WHEN SUBSTR(A.GL_ITEM_CODE,1,8) = '20011005'           THEN '12MH6'
                     END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN A.CUST_NAME LIKE '%社保基金%' OR A.CUST_NAME LIKE '%社会保障基金%'THEN '12MHM'
             WHEN A.CUST_NAME LIKE '%部队%'     OR A.CUST_NAME LIKE '%军队%'        THEN '12MHN'
             WHEN A.CUST_NAME LIKE '%住房公积金%'                                   THEN '12MHP'
             ELSE '12MHJ'
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY' THEN A.ACCT_BAL
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_TRAN_FINANCING A -- 理财交易信息表  
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND A.ACCT_BAL > 0 -- 账户余额 >0
    AND SUBSTR(A.ITEM_ID,1,4) = '2008'
    GROUP BY A.CRT_NO,
       (CASE WHEN A.CUST_NAME LIKE '%社保基金%' OR A.CUST_NAME LIKE '%社会保障基金%'THEN '12MHM'
             WHEN A.CUST_NAME LIKE '%部队%'     OR A.CUST_NAME LIKE '%军队%'        THEN '12MHN'
             WHEN A.CUST_NAME LIKE '%住房公积金%'                                   THEN '12MHP'
             ELSE '12MHJ'
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MGA' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MGH' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MGQ' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MH3' -- 账户类型=协议存款
             WHEN A.ACCT_TYPE  = 'M030006' THEN '12MHA' -- 账户类型=协定存款
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID 
         AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID  ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND C.RESIDENT_FLG ='C024002'  -- 居民标志 : 非居民  
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
  GROUP BY A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MGA' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MGH' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MGQ' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MH3' -- 账户类型=协议存款
             WHEN A.ACCT_TYPE = 'M030006' THEN '12MHA' -- 账户类型=协定存款
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' THEN '12MHH' -- 账户类型=保证金存款
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID 
         AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND C.RESIDENT_FLG ='C024002'  -- 居民标志 : 非居民  
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,4) = '2014'
  GROUP BY A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030007' THEN '12MHH' -- 账户类型=保证金存款
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MI2' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MI4' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030003' THEN '12MI6' -- 账户类型=定活两便
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MI8' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MIA' -- 账户类型=协议存款
          -- WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030010' THEN '12MIG' -- 账户类型=结构性存款
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  INNER JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
  GROUP BY A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MI2' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MI4' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030003' THEN '12MI6' -- 账户类型=定活两便
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MI8' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MIA' -- 账户类型=协议存款
          -- WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030010' THEN '12MIG' -- 账户类型=结构性存款
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN B.RESIDENT_FLG  = 'C024002' THEN '12MIF'
             ELSE '12MIE'
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  INNER JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,4) = '2014'
  GROUP BY A.CRT_NO,
       (CASE WHEN B.RESIDENT_FLG  = 'C024002' THEN '12MIF'
             ELSE '12MIE'
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT T.CRT_NO,
       T.ITEM_CD,
       SUM(T.ITEMVALUE1) AS ITEMVALUE1
  FROM (SELECT A.CRT_NO,
               '12MIC' AS ITEM_CD,
               SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                        ELSE 0
                        END) AS ITEMVALUE1 -- 账户余额
          FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
          INNER JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
                  ON A.CUST_ID = B.CBOD_CUST_ID
                 AND B.SRCSYS_CD = 'CBOD'
          WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.CRT_NO_ID ${hiveconf:crt_condition}
            AND B.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
            AND A.ACCT_BALANCE > 0 -- 账户余额 >0
            AND A.ACCT_TYPE = 'M030006' -- 账户类型=协定存款
          GROUP BY A.CRT_NO
        UNION ALL
        SELECT A.CRT_NO,
               '12MIC' AS ITEM_CD,
               SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                        ELSE 0
                        END) AS ITEMVALUE1 -- 账户余额 
          FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
          INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
                  ON A.CUST_ID = C.CBOD_CUST_ID 
                 AND C.SRCSYS_CD = 'CBOD'
          WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
            AND A.CRT_NO_ID ${hiveconf:crt_condition}    
            AND C.DATA_DT_ID = '${hiveconf:data_dt}'
            AND C.RESIDENT_FLG != 'C024002' -- 居民标识!=非居民
            AND C.SRCSYS_CD='CBOD'
            AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
            AND A.ACCT_BALANCE > 0 -- 账户余额 >0
            AND SUBSTR(A.GL_ITEM_CODE,1,8) = '20011505'
            AND A.ACCT_TYPE = 'M030006' -- 账户类型=协定存款
          GROUP BY A.CRT_NO ) T
  GROUP BY T.CRT_NO,T.ITEM_CD) T1
)RSLT WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MI3' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MI5' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030003' THEN '12MI7' -- 账户类型=定活两便
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MI9' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MIB' -- 账户类型=协议存款
             WHEN A.ACCT_TYPE = 'M030006' THEN '12MID' -- 账户类型=协定存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030010' THEN '12MIH' -- 账户类型=结构性存款
             END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND B.RESIDENT_FLG = 'C024002'  -- 居民标志 : 非居民
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
  GROUP BY A.CRT_NO,
       (CASE WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030005' THEN '12MI3' -- 账户类型=活期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030001' THEN '12MI5' -- 账户类型=定期存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030003' THEN '12MI7' -- 账户类型=定活两便
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030004' THEN '12MI9' -- 账户类型=通知存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030002' THEN '12MIB' -- 账户类型=协议存款
             WHEN A.ACCT_TYPE = 'M030006' THEN '12MID' -- 账户类型=协定存款
             WHEN SUBSTR(A.ACCT_TYPE,1,7) = 'M030010' THEN '12MIH' -- 账户类型=结构性存款
             END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

--标识:缺失的资金部分03此标识与下面脚本无关

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
      '12MW5' AS ITEM_CD,
       SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                ELSE 0
                END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  INNER JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,6) = '200406'
    AND B.RESIDENT_FLG != 'C024002' -- 居民标志!=非居民
--    AND B.ID_TYPE != 'C006003' -- 证件类型 社会团体证
  GROUP BY A.CRT_NO ) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
      (CASE WHEN B.ID_TYPE  = 'C006003' THEN '12MW6' -- 证件类型=社会团体证
            WHEN B.ID_TYPE != 'C006003' THEN '12MW7' -- 证件类型!=社会团体证
            END) AS ITEM_CD,
       SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                ELSE 0
                END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  INNER JOIN FDM_DATA.FDM_CUST_C B -- 对公客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,6) = '200206'
    AND B.RESIDENT_FLG != 'C024002' -- 居民标志!=非居民 
    AND B.CUST_NAM NOT LIKE '%社保基金%'
    AND B.CUST_NAM NOT LIKE '%社会保障基金%'
    AND B.CUST_NAM NOT LIKE '%部队%'
    AND B.CUST_NAM NOT LIKE '%军队%'
    AND B.CUST_NAM NOT LIKE '%住房公积金%'
  GROUP BY A.CRT_NO,
      (CASE WHEN B.ID_TYPE  = 'C006003' THEN '12MW6' -- 证件类型=社会团体证
            WHEN B.ID_TYPE != 'C006003' THEN '12MW7' -- 证件类型!=社会团体证
            END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
      (CASE WHEN B.CUST_NAM LIKE '%社保基金%' OR B.CUST_NAM LIKE '%社会保障基金%' THEN '12MW8'
            WHEN B.CUST_NAM LIKE '%部队%'     OR B.CUST_NAM LIKE '%军队%'         THEN '12MW9'
            WHEN B.CUST_NAM LIKE '%住房公积金%'                                   THEN '12MWA'
            END) AS ITEM_CD,
       SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                ELSE 0
                END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  INNER JOIN FDM_DATA.FDM_CUST_C B -- 对公客户信息表
          ON A.CUST_ID = B.CBOD_CUST_ID
         AND B.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,6) = '200206'
    AND B.RESIDENT_FLG != 'C024002' -- 居民标志!=非居民
  GROUP BY A.CRT_NO,
      (CASE WHEN B.CUST_NAM LIKE '%社保基金%' OR B.CUST_NAM LIKE '%社会保障基金%' THEN '12MW8'
            WHEN B.CUST_NAM LIKE '%部队%'     OR B.CUST_NAM LIKE '%军队%'         THEN '12MW9'
            WHEN B.CUST_NAM LIKE '%住房公积金%'                                   THEN '12MWA'
            END) ) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
      '12MWB' AS ITEM_CD,
       SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                ELSE 0
                END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表
  LEFT JOIN FDM_DATA.FDM_CUST_P B -- 个人客户信息表
         ON A.CUST_ID = B.CBOD_CUST_ID
        AND B.SRCSYS_CD = 'CBOD'
  LEFT JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
         ON A.CUST_ID = C.CBOD_CUST_ID
        AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND B.DATA_DT_ID = '${hiveconf:data_dt}'
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0
    AND SUBSTR(A.GL_ITEM_CODE,1,6) IN ('200406','200206')
    AND (B.RESIDENT_FLG = 'C024002' OR C.RESIDENT_FLG = 'C024002') -- 居民标志=非居民
  GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       '12MVJ' AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 余额
  FROM FDM_DATA.FDM_FUND_MMFUND A -- 资金业务信息表 
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID  ${hiveconf:crt_condition}
    AND A.ACCT_TYP IN ('G080008001','G080008002') -- 资金业务类型=支农再贷款,支小再贷款
    AND A.MATURE_DATE > '${hiveconf:data_dt}' -- 到期日>报告日
  GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       '12MVT' AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID 
         AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0 
    AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20020530','20020535','20020636','20060660','20022530','20022535')
    AND C.CUST_NAM NOT LIKE '%社保基金%'
    AND C.CUST_NAM NOT LIKE '%社会保障基金%'
    AND C.CUST_NAM NOT LIKE '%部队%'
    AND C.CUST_NAM NOT LIKE '%军队%'
  GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
       '12MVU' AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID 
         AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID  ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0 
    AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20021530','20021535')
    AND C.CUST_NAM NOT LIKE '%社保基金%'
    AND C.CUST_NAM NOT LIKE '%社会保障基金%'
    AND C.CUST_NAM NOT LIKE '%部队%'
    AND C.CUST_NAM NOT LIKE '%军队%'
  GROUP BY A.CRT_NO) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

USE DM_DATA;
INSERT INTO  TABLE DM_DATA.rep_data PARTITION(DATA_DT_ID, CRT_NO_ID, REPORT_ID_ID)
SELECT RSLT.*
  FROM (SELECT T1.CRT_NO      AS ORGAN_ID,
               CONCAT(SUBSTR('${hiveconf:data_dt}', 1, 6), '00') AS REPORT_DATE,
               from_unixtime(unix_timestamp(),'yyyyMMdd')        AS CREATE_DATE,
               '612'          AS REPORT_ID,
               T1.ITEM_CD     AS ITEMID,
               T1.ITEMVALUE1  AS ITEMVALUE1,
               0.0            AS ITEMVALUE2,
               0.0            AS ITEMVALUE3,
               0.0            AS ITEMVALUE4,
               0.0            AS ITEMVALUE5,
               0.0            AS ITEMVALUE6,
               0.0            AS ITEMVALUE7,
               0.0            AS ITEMVALUE8,
               0.0            AS ITEMVALUE9,
               0.0            AS ITEMVALUE10,
               0.0            AS ITEMVALUE11,
               0.0            AS ITEMVALUE12,
               0.0            AS ITEMVALUE13,
               0.0            AS ITEMVALUE14,
               0.0            AS ITEMVALUE15,
               0.0            AS ITEMVALUE16,
               0.0            AS ITEMVALUE17,
               0.0            AS ITEMVALUE18,
               0.0            AS ITEMVALUE19,
               0.0            AS ITEMVALUE20,
               0.0            AS ITEMVALUE21,
               0.0            AS ITEMVALUE22,
               0.0            AS ITEMVALUE23,
               0.0            AS ITEMVALUE24,
               0.0            AS ITEMVALUE25,
               0.0            AS ITEMVALUE26,
               0.0            AS ITEMVALUE27,
               0.0            AS ITEMVALUE28,
               0.0            AS ITEMVALUE29,
               0.0            AS ITEMVALUE30,
               0.0            AS ITEMVALUE31,
               0.0            AS ITEMVALUE32,
               0.0            AS ITEMVALUE33,
               0.0            AS ITEMVALUE34,
               0.0            AS ITEMVALUE35,
               0.0            AS ITEMVALUE36,
               0.0            AS ITEMVALUE37,
               0.0            AS ITEMVALUE38,
               0.0            AS ITEMVALUE39,
               0.0            AS ITEMVALUE40,
               0.0            AS ITEMVALUE41,
               0.0            AS ITEMVALUE42,
               0.0            AS ITEMVALUE43,
               0.0            AS ITEMVALUE44,
               0.0            AS ITEMVALUE45,
               0.0            AS ITEMVALUE46,
               0.0            AS ITEMVALUE47,
               0.0            AS ITEMVALUE48,
               0.0            AS ITEMVALUE49,
               0.0            AS ITEMVALUE50,
               '1'            AS PKID,
               '${hiveconf:data_dt}' AS DATA_DT_ID,
               T1.CRT_NO      AS CRT_NO_ID,
               '612'          AS REPORT_ID_ID
  FROM (SELECT A.CRT_NO,
        (CASE WHEN C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%' THEN '12MVV'
              WHEN C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%'         THEN '12MVW'
              END) AS ITEM_CD,
        SUM(CASE WHEN A.CURR_CD = 'CNY'  THEN A.ACCT_BALANCE
                 ELSE 0
                 END) AS ITEMVALUE1 -- 账户余额 
  FROM FDM_DATA.FDM_DEPO_ACCT A -- 存款账户信息表  
  INNER JOIN FDM_DATA.FDM_CUST_C C -- 对公客户信息表
          ON A.CUST_ID = C.CBOD_CUST_ID 
         AND C.SRCSYS_CD = 'CBOD'
  WHERE A.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.CRT_NO_ID  ${hiveconf:crt_condition}
    AND C.DATA_DT_ID = '${hiveconf:data_dt}'
    AND A.ACCT_STS != 'M005005' -- 账户状态!=销户
    AND A.ACCT_BALANCE > 0 -- 账户余额 >0 
    AND SUBSTR(A.GL_ITEM_CODE,1,8) IN ('20020530','20020535','20020636','20060660','20021530','20021535','20022530','20022535')
  GROUP BY A.CRT_NO,
        (CASE WHEN C.CUST_NAM LIKE '%社保基金%' OR C.CUST_NAM LIKE '%社会保障基金%' THEN '12MVV'
              WHEN C.CUST_NAM LIKE '%部队%'     OR C.CUST_NAM LIKE '%军队%'         THEN '12MVW'
              END)) T1
)RSLT  WHERE RSLT.ITEMID IS NOT NULL;

